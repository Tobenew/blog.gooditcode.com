(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{473:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"react-fiber-æ¶æ„è§£æ"}},[t._v("React Fiber æ¶æ„è§£æ")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("æœ¬æ–‡æ¥æºäº"),a("a",{attrs:{href:"https://medium.com/@maxim.koretskyi",target:"_blank",rel:"noopener noreferrer"}},[t._v("Max Koretskyi aka Wizard"),a("OutboundLink")],1),t._v("\nçš„"),a("a",{attrs:{href:"https://medium.com/react-in-depth/inside-fiber-in-depth-overview-of-the-new-reconciliation-algorithm-in-react-e1c04700ef6e",target:"_blank",rel:"noopener noreferrer"}},[t._v("Inside Fiber: in-depth overview of the new reconciliation algorithm in React\n"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("å‘æ›´æ·±å…¥ç†è§£Reactçš„å…¨è²Œ,å»ºè®®é˜…è¯»æ­¤"),a("a",{attrs:{href:"https://github.com/pomber/didact",target:"_blank",rel:"noopener noreferrer"}},[t._v("ä»“åº“"),a("OutboundLink")],1),t._v(",å®ƒä¼šäº¤ç»™ä½ å¦‚ä½•æ‰“é€ ä¸€ä¸ªç®€æ˜“çš„react")]),t._v(" "),a("hr"),t._v(" "),a("p",[t._v("React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·äº¤äº’ç•Œé¢çš„ JavaScript åº“ï¼Œå…¶æ ¸å¿ƒæœºåˆ¶å°±æ˜¯è·Ÿè¸ªç»„ä»¶çš„çŠ¶æ€å˜åŒ–ï¼Œå¹¶å°†æ›´æ–°çš„çŠ¶æ€æ˜ å°„åˆ°åˆ°æ–°çš„ç•Œé¢ã€‚åœ¨ React ä¸­ï¼Œæˆ‘ä»¬å°†æ­¤è¿‡ç¨‹ç§°ä¹‹ä¸º"),a("strong",[t._v("åè°ƒ")]),t._v("ã€‚æˆ‘ä»¬è°ƒç”¨Â "),a("code",[t._v("setState")]),t._v("æ–¹æ³•æ¥æ”¹å˜çŠ¶æ€ï¼Œè€Œæ¡†æ¶æœ¬èº«ä¼šå»æ£€æŸ¥ state æˆ– props æ˜¯å¦å·²ç»æ›´æ”¹æ¥å†³å®šæ˜¯å¦é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚"),a("br"),t._v("React çš„å®˜æ–¹æ–‡æ¡£å¯¹Â "),a("a",{attrs:{href:"https://reactjs.org/docs/reconciliation.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("åè°ƒæœºåˆ¶"),a("OutboundLink")],1),t._v("Â è¿›è¡Œäº†è‰¯å¥½çš„æŠ½è±¡æè¿°ï¼š React çš„å…ƒç´ ã€ç”Ÿå‘½å‘¨æœŸã€Â "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•ï¼Œä»¥åŠåº”ç”¨äºç»„ä»¶å­å…ƒç´ çš„ diffing ç®—æ³•ç»¼åˆèµ·åˆ°çš„ä½œç”¨ï¼Œå°±æ˜¯åè°ƒã€‚ä»Â "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•è¿”å›çš„ä¸å¯å˜çš„ React å…ƒç´ é€šå¸¸ç§°ä¸ºã€Œè™šæ‹Ÿ DOMã€ã€‚è¿™ä¸ªæœ¯è¯­æœ‰åŠ©äºæ—©æœŸå‘äººä»¬è§£é‡Š Reactï¼Œä½†å®ƒä¹Ÿå¼•èµ·äº†æ··ä¹±ï¼Œå¹¶ä¸”ä¸å†ç”¨äº React æ–‡æ¡£ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†åšæŒç§°å®ƒä¸º React å…ƒç´ çš„æ ‘ã€‚"),a("br"),t._v("é™¤äº† React å…ƒç´ çš„æ ‘ä¹‹å¤–ï¼Œæ¡†æ¶æ€»æ˜¯åœ¨å†…éƒ¨ç»´æŠ¤ä¸€ä¸ªå®ä¾‹æ¥æŒæœ‰çŠ¶æ€ï¼ˆå¦‚ç»„ä»¶ã€ DOM èŠ‚ç‚¹ç­‰ï¼‰ã€‚ä»ç‰ˆæœ¬ 16 å¼€å§‹ï¼Œ React æ¨å‡ºäº†å†…éƒ¨å®ä¾‹æ ‘çš„æ–°çš„å®ç°æ–¹æ³•ï¼Œä»¥åŠè¢«ç§°ä¹‹ä¸ºÂ "),a("strong",[t._v("Fiber")]),t._v("Â çš„ç®—æ³•ã€‚å¦‚æœæƒ³è¦äº†è§£ Fiber æ¶æ„å¸¦æ¥çš„ä¼˜åŠ¿ï¼Œå¯ä»¥çœ‹ä¸‹Â "),a("a",{attrs:{href:"https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7",target:"_blank",rel:"noopener noreferrer"}},[t._v("React åœ¨ Fiber ä¸­ä½¿ç”¨é“¾è¡¨çš„æ–¹å¼å’ŒåŸå› "),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("p",[t._v("è¿™æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸€ç³»åˆ—çš„ç›®çš„å°±æ˜¯å‘ä½ æç»˜å‡º React çš„å†…éƒ¨æ¶æ„ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å¸Œæœ›èƒ½å¤Ÿæä¾›ä¸€äº›ä¸ç®—æ³•ç›¸å…³çš„é‡è¦æ¦‚å¿µå’Œæ•°æ®ç»“æ„ï¼Œå¹¶å¯¹å…¶è¿›è¡Œæ·±å…¥é˜è¿°ã€‚ä¸€æ—¦æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„èƒŒæ™¯ï¼Œæˆ‘ä»¬å°†æ¢ç´¢ç”¨äºéå†å’Œå¤„ç† Fiber æ ‘çš„ç®—æ³•å’Œä¸»è¦åŠŸèƒ½ã€‚æœ¬ç³»åˆ—çš„ä¸‹ä¸€ç¯‡æ–‡ç« å°†æ¼”ç¤º React å¦‚ä½•ä½¿ç”¨è¯¥ç®—æ³•æ‰§è¡Œåˆå§‹æ¸²æŸ“å’Œå¤„ç† state ä»¥åŠ props çš„æ›´æ–°ã€‚åˆ°é‚£æ—¶ï¼Œæˆ‘ä»¬å°†ç»§ç»­è®¨è®ºè°ƒåº¦ç¨‹åºçš„è¯¦ç»†ä¿¡æ¯ï¼Œå­åè°ƒè¿‡ç¨‹ä»¥åŠæ„å»º effect åˆ—è¡¨çš„æœºåˆ¶ã€‚"),a("br"),t._v("æˆ‘å°†ç»™ä½ å¸¦æ¥ä¸€äº›éå¸¸é«˜é˜¶çš„çŸ¥è¯†ğŸ§™ã€‚æˆ‘é¼“åŠ±ä½ é˜…è¯»æ¥äº†è§£ Concurrent React çš„å†…éƒ¨å·¥ä½œçš„é­”åŠ›ã€‚å¦‚æœæ‚¨è®¡åˆ’å¼€å§‹ä¸º React è´¡çŒ®ä»£ç ï¼Œæœ¬ç³»åˆ—ä¹Ÿå°†ä¸ºæ‚¨æä¾›å¾ˆå¥½çš„æŒ‡å¯¼ã€‚æˆ‘æ˜¯Â "),a("a",{attrs:{href:"https://blog.angularindepth.com/level-up-your-reverse-engineering-skills-8f910ae10630",target:"_blank",rel:"noopener noreferrer"}},[t._v("é€†å‘å·¥ç¨‹çš„åšå®šä¿¡å¾’"),a("OutboundLink")],1),t._v("ï¼Œå› æ­¤æœ¬æ–‡ä¼šæœ‰å¾ˆå¤šæœ€æ–°ç‰ˆæœ¬ 16.6.0 ä¸­çš„æºä»£ç çš„é“¾æ¥ã€‚"),a("br"),t._v("éœ€è¦æ¶ˆåŒ–çš„å†…å®¹ç»å¯¹æ˜¯å¾ˆå¤šçš„ï¼Œæ‰€ä»¥å¦‚æœä½ å½“ä¸‹è¿˜ä¸èƒ½å¾ˆç†è§£çš„è¯ï¼Œä¸ç”¨æ„Ÿåˆ°å‹åŠ›ã€‚èŠ±äº›æ—¶é—´æ˜¯å€¼å¾—çš„ã€‚**è¯·æ³¨æ„ï¼Œåªæ˜¯ä½¿ç”¨ React çš„è¯ï¼Œæ‚¨ä¸éœ€è¦çŸ¥é“ä»»ä½•æ–‡ä¸­çš„å†…å®¹ã€‚æœ¬æ–‡æ˜¯å…³äº React åœ¨å†…éƒ¨æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚")]),t._v(" "),a("h2",{attrs:{id:"èƒŒæ™¯ä»‹ç»"}},[t._v("èƒŒæ™¯ä»‹ç»")]),t._v(" "),a("p",[t._v("å¦‚ä¸‹æ˜¯æˆ‘å°†åœ¨æ•´ä¸ªç³»åˆ—ä¸­ä½¿ç”¨çš„ä¸€ä¸ªç®€å•çš„åº”ç”¨ç¨‹åºã€‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæŒ‰é’®ï¼Œç‚¹å‡»å®ƒå°†ä¼šä½¿å±å¹•ä¸Šæ¸²æŸ“çš„æ•°å­—åŠ  1ï¼š"),a("br"),a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2019/gif/128853/1564754956577-e0ebe7ee-af11-4e2e-8712-2d5eb1b986bb.gif#align=left&display=inline&height=68&originHeight=68&originWidth=210&size=0&status=done&width=210",alt:""}}),a("br"),t._v("è€Œå®ƒçš„å®ç°å¦‚ä¸‹ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClickCounter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Component")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constructor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("props")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("super")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("props"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handleClick "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleClick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("handleClick")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setState")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("state")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("handleClick"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Update counter")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br")])]),a("p",[t._v("ä½ å¯ä»¥åœ¨Â "),a("a",{attrs:{href:"https://stackblitz.com/edit/react-t4rdmh",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿™é‡Œ"),a("OutboundLink")],1),t._v("Â æŠŠç©ä¸€ä¸‹ã€‚å¦‚æ‚¨æ‰€è§ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªå¯ä»Â "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•è¿”å›ä¸¤ä¸ªå­å…ƒç´  --Â "),a("code",[t._v("button")]),t._v("Â å’ŒÂ "),a("code",[t._v("span")]),t._v("Â çš„ç®€å•ç»„ä»¶ã€‚åªè¦ä½ å•å‡»è¯¥æŒ‰é’®ï¼Œç»„ä»¶çš„çŠ¶æ€å°†åœ¨å¤„ç†ç¨‹åºå†…è¢«æ›´æ–°ï¼Œè€ŒçŠ¶æ€çš„æ›´æ–°å°±ä¼šå¯¼è‡´Â "),a("code",[t._v("span")]),t._v("Â å…ƒç´ å†…çš„æ–‡æœ¬æ›´æ–°ã€‚"),a("br"),t._v("åœ¨åè°ƒé˜¶æ®µå†…ï¼ŒReact è¿›è¡Œäº†å„ç§å„æ ·çš„æ´»åŠ¨ã€‚ä¾‹å¦‚ï¼Œåœ¨æˆ‘ä»¬çš„ç®€å•åº”ç”¨ç¨‹åºä¸­ï¼Œä»ç¬¬ä¸€æ¬¡æ¸²æŸ“åˆ°çŠ¶æ€æ›´æ–°åçš„æœŸé—´å†…ï¼ŒReact æ‰§è¡Œäº†å¦‚ä¸‹é«˜é˜¶æ“ä½œï¼š")]),t._v(" "),a("ul",[a("li",[t._v("æ›´æ–°äº†Â "),a("code",[t._v("ClickCounter")]),t._v("Â ç»„ä»¶çš„å†…éƒ¨çŠ¶æ€çš„Â "),a("code",[t._v("count")]),t._v("Â å±æ€§"),a("br")]),t._v(" "),a("li",[t._v("è·å–å’Œæ¯”è¾ƒäº†Â "),a("code",[t._v("ClickCounter")]),t._v("Â ç»„ä»¶çš„å­ç»„ä»¶åŠå…¶ props"),a("br")]),t._v(" "),a("li",[t._v("æ›´æ–°Â "),a("code",[t._v("span")]),t._v("Â å…ƒç´ çš„ props"),a("br")]),t._v(" "),a("li",[t._v("æ›´æ–°Â "),a("code",[t._v("span")]),t._v("Â å…ƒç´ çš„Â "),a("code",[t._v("textContent")]),t._v("Â å±æ€§"),a("br")])]),t._v(" "),a("p",[t._v("é™¤äº†ä¸Šè¿°æ´»åŠ¨ï¼ŒReact åœ¨åè°ƒæœŸé—´è¿˜æ‰§è¡Œäº†ä¸€äº›å…¶ä»–æ´»åŠ¨ï¼Œå¦‚è°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æˆ–æ›´æ–°Â refsã€‚**æ‰€æœ‰è¿™äº›æ´»åŠ¨åœ¨ Fiber æ¶æ„ä¸­ç»Ÿç§°ä¸ºã€Œå·¥ä½œã€ã€‚**å·¥ä½œç±»å‹é€šå¸¸å–å†³äº React å…ƒç´ çš„ç±»å‹ã€‚ä¾‹å¦‚ï¼Œå¯¹äºç±»å®šä¹‰çš„ç»„ä»¶ï¼ŒReact éœ€è¦åˆ›å»ºå®ä¾‹ï¼Œä½†æ˜¯å‡½æ•°å®šä¹‰çš„ç»„ä»¶å°±ä¸å¿…æ‰§è¡Œæ­¤æ“ä½œã€‚æ­£å¦‚æˆ‘ä»¬æ‰€äº†è§£çš„ï¼ŒReact ä¸­æœ‰è®¸å¤šå…ƒç´ ç±»å‹ï¼Œä¾‹å¦‚ï¼šç±»å’Œå‡½æ•°ç»„ä»¶ï¼Œå®¿ä¸»ç»„ä»¶ï¼ˆDOM èŠ‚ç‚¹ï¼‰portal ç­‰ã€‚React å…ƒç´ çš„ç±»å‹ç”±Â createElementå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°å®šä¹‰ï¼Œæ­¤å‡½æ•°é€šå¸¸åœ¨Â "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•ä¸­è°ƒç”¨ä»¥åˆ›å»ºå…ƒç´ ã€‚"),a("br"),t._v("åœ¨æˆ‘ä»¬å¼€å§‹æ¢ç´¢æ´»åŠ¨ç»†èŠ‚å’Œ Fiber ç®—æ³•çš„ä¸»è¦å†…å®¹ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥ç†Ÿæ‚‰ä¸‹ React åœ¨å†…éƒ¨ä½¿ç”¨çš„ä¸€äº›æ•°æ®ç»“æ„ã€‚")]),t._v(" "),a("h2",{attrs:{id:"ä»-react-å…ƒç´ åˆ°-fiber-èŠ‚ç‚¹"}},[t._v("ä» React å…ƒç´ åˆ° Fiber èŠ‚ç‚¹")]),t._v(" "),a("p",[t._v("React ä¸­çš„æ¯ä¸ªç»„ä»¶éƒ½æœ‰ä¸€ä¸ª UI è¡¨ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºä»Â "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•è¿”å›çš„ä¸€ä¸ªè§†å›¾æˆ–æ¨¡æ¿ã€‚è¿™æ˜¯Â "),a("code",[t._v("ClickCounter")]),t._v("Â ç»„ä»¶çš„æ¨¡æ¿ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("onClick")]),a("span",{pre:!0,attrs:{class:"token script language-javascript"}},[a("span",{pre:!0,attrs:{class:"token script-punctuation punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onClick"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token plain-text"}},[t._v("Update counter")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("span")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("key")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("span")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("h3",{attrs:{id:"react-å…ƒç´ "}},[t._v("React å…ƒç´ ")]),t._v(" "),a("p",[t._v("å¦‚æœæ¨¡æ¿ç»è¿‡ JSX ç¼–è¯‘å™¨å¤„ç†ï¼Œä½ å°±ä¼šå¾—åˆ°ä¸€å † React å…ƒç´ ã€‚è¿™æ˜¯ä» React ç»„ä»¶çš„ render æ–¹æ³•è¿”å›çš„ï¼Œä½†å¹¶ä¸æ˜¯ HTML ã€‚ç”±äºæˆ‘ä»¬å¹¶æ²¡æœ‰è¢«å¼ºåˆ¶è¦æ±‚ä½¿ç”¨ JSXï¼Œå› æ­¤æˆ‘ä»¬çš„ ClickCounter ç»„ä»¶çš„ render æ–¹æ³•å¯ä»¥åƒè¿™æ ·é‡å†™ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClickCounter")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n            React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'button'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    onClick"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("onClick\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Update counter'")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            React"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2'")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br")])]),a("p",[a("code",[t._v("render")]),t._v("Â æ–¹æ³•ä¸­è°ƒç”¨çš„Â "),a("code",[t._v("React.createElement")]),t._v("Â ä¼šäº§ç”Ÿä¸¤ä¸ªå¦‚ä¸‹çš„æ•°æ®ç»“æ„ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        $$"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("react"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'button'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            children"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Update counter'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onClick")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        $$"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("react"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'span'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            children"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])]),a("p",[t._v("å¯ä»¥çœ‹åˆ°ï¼ŒReact ä¸ºè¿™äº›å¯¹è±¡æ·»åŠ äº†Â "),a("code",[t._v("$$typeof")]),t._v("Â å±æ€§ï¼Œä»è€Œå°†å®ƒä»¬å”¯ä¸€åœ°æ ‡è¯†ä¸º React å…ƒç´ ã€‚æ­¤å¤–æˆ‘ä»¬è¿˜æœ‰å±æ€§Â "),a("code",[t._v("type")]),t._v("ã€"),a("code",[t._v("key")]),t._v("Â å’ŒÂ "),a("code",[t._v("props")]),t._v("Â æ¥æè¿°å…ƒç´ ã€‚è¿™äº›å€¼å–è‡ªä½ ä¼ é€’ç»™Â "),a("code",[t._v("React.createElement")]),t._v("å‡½æ•°çš„å‚æ•°ã€‚è¯·æ³¨æ„React å¦‚ä½•å°†æ–‡æœ¬å†…å®¹è¡¨ç¤ºä¸ºÂ "),a("code",[t._v("span")]),t._v("Â å’ŒÂ "),a("code",[t._v("button")]),t._v("Â èŠ‚ç‚¹çš„å­é¡¹ï¼Œä»¥åŠ click é’©å­å¦‚ä½•æˆä¸ºÂ "),a("code",[t._v("button")]),t._v("Â å…ƒç´  props çš„ä¸€éƒ¨åˆ†ã€‚ React å…ƒç´ ä¸Šè¿˜æœ‰å…¶ä»–å­—æ®µï¼Œå¦‚Â "),a("code",[t._v("ref")]),t._v("Â å­—æ®µï¼Œè€Œè¿™è¶…å‡ºäº†æœ¬æ–‡çš„èŒƒå›´ã€‚"),a("br"),t._v("è€ŒÂ "),a("code",[t._v("ClickCounter")]),t._v("Â çš„ React å…ƒç´ å°±æ²¡æœ‰ä»€ä¹ˆ props æˆ– key å±æ€§:")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    $$"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("typeof")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Symbol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("react"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("element"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    props"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ref"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ClickCounter\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("h3",{attrs:{id:"fiber-èŠ‚ç‚¹"}},[t._v("Fiber èŠ‚ç‚¹")]),t._v(" "),a("p",[t._v("åœ¨"),a("code",[t._v("åè°ƒ")]),t._v("æœŸé—´ï¼Œä»Â "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•è¿”å›çš„æ¯ä¸ª React å…ƒç´ çš„æ•°æ®éƒ½ä¼šè¢«åˆå¹¶åˆ° Fiber èŠ‚ç‚¹æ ‘ä¸­ã€‚æ¯ä¸ª React å…ƒç´ éƒ½æœ‰ä¸€ä¸ªç›¸åº”çš„ Fiber èŠ‚ç‚¹ã€‚ä¸ React å…ƒç´ ä¸åŒï¼Œä¸ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»ºè¿™äº› Fiber ã€‚è¿™äº›æ˜¯æŒæœ‰ç»„ä»¶çŠ¶æ€å’Œ DOM çš„å¯å˜æ•°æ®ç»“æ„ã€‚"),a("br"),t._v("æˆ‘ä»¬ä¹‹å‰è®¨è®ºè¿‡ï¼Œæ ¹æ®ä¸åŒ React å…ƒç´ çš„ç±»å‹ï¼Œæ¡†æ¶éœ€è¦æ‰§è¡Œä¸åŒçš„æ´»åŠ¨ã€‚åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºä¸­ï¼Œå¯¹äºç±»ç»„ä»¶Â "),a("code",[t._v("ClickCounter")]),t._v("Â ï¼Œå®ƒè°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’ŒÂ "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•ï¼Œè€Œå¯¹äºÂ "),a("code",[t._v("span")]),t._v("Â å®¿ä¸»ç»„ä»¶ï¼ˆDOM èŠ‚ç‚¹ï¼‰ï¼Œå®ƒè¿›è¡Œå¾—æ˜¯ DOM ä¿®æ”¹ã€‚å› æ­¤ï¼Œæ¯ä¸ª React å…ƒç´ éƒ½ä¼šè½¬æ¢ä¸ºÂ "),a("a",{attrs:{href:"https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/shared/ReactWorkTags.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("ç›¸åº”ç±»å‹"),a("OutboundLink")],1),t._v("Â çš„ Fiber èŠ‚ç‚¹ï¼Œç”¨äºæè¿°éœ€è¦å®Œæˆçš„å·¥ä½œã€‚"),a("br"),a("strong",[t._v("æ‚¨å¯ä»¥å°† Fiber è§†ä¸ºè¡¨ç¤ºæŸäº›è¦åšçš„å·¥ä½œçš„æ•°æ®ç»“æ„ï¼Œæˆ–è€…è¯´ï¼Œæ˜¯ä¸€ä¸ªå·¥ä½œå•ä½ã€‚Fiber çš„æ¶æ„è¿˜æä¾›äº†ä¸€ç§è·Ÿè¸ªã€è§„åˆ’ã€æš‚åœå’Œé”€æ¯å·¥ä½œçš„ä¾¿æ·æ–¹å¼ã€‚")]),a("br"),t._v("å½“ React å…ƒç´ ç¬¬ä¸€æ¬¡è½¬æ¢ä¸º Fiber èŠ‚ç‚¹æ—¶ï¼ŒReact åœ¨Â createFiberFromTypeAndPropså‡½æ•°ä¸­ä½¿ç”¨å…ƒç´ ä¸­çš„æ•°æ®æ¥åˆ›å»º Fiberã€‚åœ¨éšåçš„æ›´æ–°ä¸­ï¼ŒReact ä¼šå†æ¬¡åˆ©ç”¨ Fiber èŠ‚ç‚¹ï¼Œå¹¶ä½¿ç”¨æ¥è‡ªç›¸åº” React å…ƒç´ çš„æ•°æ®æ›´æ–°å¿…è¦çš„å±æ€§ã€‚å¦‚æœä¸å†ä»Â "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•è¿”å›ç›¸åº”çš„ React å…ƒç´ ï¼ŒReact å¯èƒ½è¿˜éœ€è¦æ ¹æ®Â "),a("code",[t._v("key")]),t._v("Â å±æ€§æ¥ç§»åŠ¨æˆ–åˆ é™¤å±‚çº§ç»“æ„ä¸­çš„èŠ‚ç‚¹ã€‚"),a("br"),a("em",[t._v("æŸ¥çœ‹Â ChildReconcilerå‡½æ•°ä»¥æŸ¥çœ‹ React ä¸ºç°æœ‰ Fiber èŠ‚ç‚¹æ‰§è¡Œçš„æ‰€æœ‰æ´»åŠ¨å’Œç›¸åº”å‡½æ•°çš„åˆ—è¡¨ã€‚")]),a("br"),t._v("å› ä¸ºReactä¸ºæ¯ä¸ª React å…ƒç´ åˆ›å»ºä¸€ä¸ª Fiber èŠ‚ç‚¹ï¼Œå¹¶ä¸”å› ä¸ºæˆ‘ä»¬æœ‰ä¸€ä¸ªè¿™äº›å…ƒç´ ç»„æˆçš„æ ‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ª Fiber èŠ‚ç‚¹æ ‘ã€‚å¯¹äºæˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œå®ƒçœ‹èµ·æ¥åƒè¿™æ ·ï¼š"),a("br"),a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2019/webp/128853/1564754956660-11f55b6e-a1fb-4199-8462-0be70e8f1be4.webp#align=left&display=inline&height=242&originHeight=242&originWidth=555&size=0&status=done&width=555",alt:""}}),a("br"),t._v("æ‰€æœ‰ Fiber èŠ‚ç‚¹éƒ½é€šè¿‡é“¾è¡¨è¿æ¥ï¼Œå…·ä½“æ˜¯ä½¿ç”¨FiberèŠ‚ç‚¹ä¸Šçš„Â "),a("code",[t._v("child")]),t._v("ã€"),a("code",[t._v("sibling")]),t._v("Â å’ŒÂ "),a("code",[t._v("return")]),t._v("Â å±æ€§ã€‚è‡³äºå®ƒä¸ºä»€ä¹ˆä»¥è¿™ç§æ–¹å¼å·¥ä½œï¼Œå¦‚æœæ‚¨è¿˜æ²¡æœ‰é˜…è¯»è¿‡æˆ‘çš„æ–‡ç« ï¼Œæ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·æŸ¥çœ‹Â "),a("a",{attrs:{href:"https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7",target:"_blank",rel:"noopener noreferrer"}},[t._v("React åœ¨ Fiber ä¸­ä½¿ç”¨é“¾è¡¨çš„æ–¹æ³•å’ŒåŸå› "),a("OutboundLink")],1),t._v("ã€‚")]),t._v(" "),a("h3",{attrs:{id:"current-æ ‘åŠ-workinprogress-æ ‘"}},[t._v("current æ ‘åŠ workInProgress æ ‘")]),t._v(" "),a("p",[t._v("åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¹‹åï¼ŒReact æœ€ç»ˆå¾—åˆ°ä¸€ä¸ª Fiber æ ‘ï¼Œå®ƒåæ˜ äº†ç”¨äºæ¸²æŸ“ UI çš„åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚è¿™æ£µæ ‘é€šå¸¸è¢«ç§°ä¸ºÂ "),a("strong",[t._v("current æ ‘ï¼ˆå½“å‰æ ‘ï¼‰")]),t._v("ã€‚å½“ React å¼€å§‹å¤„ç†æ›´æ–°æ—¶ï¼Œå®ƒä¼šæ„å»ºä¸€ä¸ªæ‰€è°“çš„Â "),a("strong",[t._v("workInProgress æ ‘ï¼ˆå·¥ä½œè¿‡ç¨‹æ ‘ï¼‰")]),t._v("ï¼Œå®ƒåæ˜ äº†è¦åˆ·æ–°åˆ°å±å¹•çš„æœªæ¥çŠ¶æ€ã€‚"),a("br"),t._v("æ‰€æœ‰å·¥ä½œéƒ½åœ¨Â "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘çš„ Fiber èŠ‚ç‚¹ä¸Šæ‰§è¡Œã€‚å½“ React éå†Â "),a("code",[t._v("current")]),t._v("Â æ ‘æ—¶ï¼Œå¯¹äºæ¯ä¸ªç°æœ‰ Fiber èŠ‚ç‚¹ï¼ŒReact ä¼šåˆ›å»ºä¸€ä¸ªæ„æˆÂ "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘çš„å¤‡ç”¨èŠ‚ç‚¹ï¼Œè¿™ä¸€èŠ‚ç‚¹ä¼šä½¿ç”¨ render æ–¹æ³•è¿”å›çš„ React å…ƒç´ ä¸­çš„æ•°æ®æ¥åˆ›å»ºã€‚å¤„ç†å®Œæ›´æ–°å¹¶å®Œæˆæ‰€æœ‰ç›¸å…³å·¥ä½œåï¼ŒReact å°†å‡†å¤‡å¥½ä¸€ä¸ªå¤‡ç”¨æ ‘ä»¥åˆ·æ–°åˆ°å±å¹•ã€‚ä¸€æ—¦è¿™ä¸ªÂ "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘åœ¨å±å¹•ä¸Šå‘ˆç°ï¼Œå®ƒå°±ä¼šå˜æˆÂ "),a("code",[t._v("current")]),t._v("æ ‘ã€‚"),a("br"),t._v("React çš„æ ¸å¿ƒåŸåˆ™ä¹‹ä¸€æ˜¯ä¸€è‡´æ€§ã€‚ React æ€»æ˜¯ä¸€æ¬¡æ€§æ›´æ–° DOM - å®ƒä¸ä¼šæ˜¾ç¤ºéƒ¨åˆ†ä¸­é—´ç»“æœã€‚"),a("code",[t._v("workInProgress")]),t._v("Â æ ‘å……å½“ç”¨æˆ·ä¸å¯è§çš„ã€Œè‰ç¨¿ã€ï¼Œè¿™æ · React å¯ä»¥å…ˆå¤„ç†æ‰€æœ‰ç»„ä»¶ï¼Œç„¶åå°†å…¶æ›´æ”¹åˆ·æ–°åˆ°å±å¹•ã€‚"),a("br"),t._v("åœ¨æºä»£ç ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°å¾ˆå¤šå‡½æ•°ä»Â "),a("code",[t._v("current")]),t._v("Â å’ŒÂ "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘ä¸­è·å– Fiber èŠ‚ç‚¹ã€‚è¿™æ˜¯ä¸€ä¸ªè¿™ç±»å‡½æ•°çš„ç­¾åï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("updateHostComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" renderExpirationTime")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("æ¯ä¸ªFiberèŠ‚ç‚¹æŒæœ‰"),a("code",[t._v("å¤‡ç”¨")]),t._v("åŸŸåœ¨å¦ä¸€ä¸ªæ ‘çš„å¯¹åº”éƒ¨åˆ†çš„å¼•ç”¨ã€‚æ¥è‡ªÂ "),a("code",[t._v("current")]),t._v("Â æ ‘ä¸­çš„èŠ‚ç‚¹ä¼šæŒ‡å‘Â "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘ä¸­çš„èŠ‚ç‚¹ï¼Œåä¹‹äº¦ç„¶ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å‰¯ä½œç”¨"}},[t._v("å‰¯ä½œç”¨")]),t._v(" "),a("p",[t._v("æˆ‘ä»¬å¯ä»¥å°† React ä¸­çš„ä¸€ä¸ªç»„ä»¶è§†ä¸ºä¸€ä¸ªä½¿ç”¨ state å’Œ props æ¥è®¡ç®— UI è¡¨ç¤ºçš„å‡½æ•°ã€‚å…¶ä»–æ‰€æœ‰æ´»åŠ¨ï¼Œå¦‚æ”¹å˜ DOM æˆ–è°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œéƒ½åº”è¯¥è¢«è§†ä¸ºå‰¯ä½œç”¨ï¼Œæˆ–è€…ç®€å•åœ°è¯´æ˜¯ä¸€ç§æ•ˆæœã€‚"),a("a",{attrs:{href:"https://reactjs.org/docs/hooks-overview.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("æ–‡æ¡£ä¸­"),a("OutboundLink")],1),t._v("æ˜¯è¿™æ ·æè¿°çš„ï¼š"),a("br"),a("em",[t._v("æ‚¨ä¹‹å‰å¯èƒ½å·²ç»åœ¨ React ç»„ä»¶ä¸­æ‰§è¡Œæ•°æ®æå–ï¼Œè®¢é˜…æˆ–æ‰‹åŠ¨æ›´æ”¹ DOMã€‚æˆ‘ä»¬å°†è¿™äº›æ“ä½œç§°ä¸ºâ€œå‰¯ä½œç”¨â€ï¼ˆæˆ–ç®€ç§°ä¸ºâ€œæ•ˆæœâ€ï¼‰ï¼Œå› ä¸ºå®ƒä»¬ä¼šå½±å“å…¶ä»–ç»„ä»¶ï¼Œå¹¶ä¸”åœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­æ— æ³•å®Œæˆã€‚")]),a("br"),t._v("æ‚¨å¯ä»¥çœ‹åˆ°å¤§å¤š state å’Œ props æ›´æ–°éƒ½ä¼šå¯¼è‡´å‰¯ä½œç”¨ã€‚æ—¢ç„¶ä½¿ç”¨å‰¯ä½œç”¨æ˜¯å·¥ä½œï¼ˆæ´»åŠ¨ï¼‰çš„ä¸€ç§ç±»å‹ï¼ŒFiber èŠ‚ç‚¹æ˜¯ä¸€ç§æ–¹ä¾¿çš„æœºåˆ¶æ¥è·Ÿè¸ªé™¤äº†æ›´æ–°ä»¥å¤–çš„æ•ˆæœã€‚æ¯ä¸ª Fiber èŠ‚ç‚¹éƒ½å¯ä»¥å…·æœ‰ä¸ä¹‹ç›¸å…³çš„å‰¯ä½œç”¨ï¼Œå®ƒä»¬å¯åœ¨Â "),a("code",[t._v("effectTag")]),t._v("Â å­—æ®µä¸­ç¼–ç ã€‚"),a("br"),t._v("å› æ­¤ï¼ŒFiber ä¸­çš„å‰¯ä½œç”¨åŸºæœ¬ä¸Šå®šä¹‰äº†å¤„ç†æ›´æ–°åéœ€è¦ä¸ºå®ä¾‹å®Œæˆçš„Â "),a("a",{attrs:{href:"https://github.com/facebook/react/blob/b87aabdfe1b7461e7331abb3601d9e6bb27544bc/packages/shared/ReactSideEffectTags.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("å·¥ä½œ"),a("OutboundLink")],1),t._v("ã€‚å¯¹äºå®¿ä¸»ç»„ä»¶ï¼ˆDOM å…ƒç´ ï¼‰ï¼Œæ‰€è°“çš„å·¥ä½œåŒ…æ‹¬æ·»åŠ ï¼Œæ›´æ–°æˆ–åˆ é™¤å…ƒç´ ã€‚å¯¹äºç±»ç»„ä»¶ï¼ŒReactå¯èƒ½éœ€è¦æ›´æ–° refs å¹¶è°ƒç”¨Â "),a("code",[t._v("componentDidMount")]),t._v("Â å’ŒÂ "),a("code",[t._v("componentDidUpdate")]),t._v("Â ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚å¯¹äºå…¶ä»–ç±»å‹çš„ Fiber ï¼Œè¿˜æœ‰ç›¸å¯¹åº”çš„å…¶ä»–å‰¯ä½œç”¨ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å‰¯ä½œç”¨åˆ—è¡¨"}},[t._v("å‰¯ä½œç”¨åˆ—è¡¨")]),t._v(" "),a("p",[t._v("React å¤„ç†æ›´æ–°çš„ç´ å¯¹éå¸¸è¿…é€Ÿï¼Œä¸ºäº†è¾¾åˆ°è¿™ç§æ°´å¹³çš„æ€§èƒ½ï¼Œå®ƒé‡‡ç”¨äº†ä¸€äº›æœ‰è¶£çš„æŠ€æœ¯ã€‚**å…¶ä¸­ä¹‹ä¸€æ˜¯æ„å»ºå…·æœ‰å‰¯ä½œç”¨çš„ Fiber èŠ‚ç‚¹çš„çº¿æ€§åˆ—è¡¨ï¼Œä»è€Œèƒ½å¤Ÿå¿«é€Ÿéå†ã€‚**éå†çº¿æ€§åˆ—è¡¨æ¯”æ ‘å¿«å¾—å¤šï¼Œå¹¶ä¸”æ²¡æœ‰å¿…è¦åœ¨æ²¡æœ‰å‰¯ä½œç”¨çš„èŠ‚ç‚¹ä¸ŠèŠ±è´¹æ—¶é—´ã€‚"),a("br"),t._v("æ­¤åˆ—è¡¨çš„ç›®æ ‡æ˜¯æ ‡è®°å…·æœ‰ DOM æ›´æ–°æˆ–å…¶ä»–ç›¸å…³å‰¯ä½œç”¨çš„èŠ‚ç‚¹ã€‚æ­¤åˆ—è¡¨æ˜¯Â "),a("code",[t._v("finishedWork")]),t._v("Â æ ‘çš„å­é›†ï¼Œå¹¶ä½¿ç”¨Â "),a("code",[t._v("nextEffect")]),t._v("Â å±æ€§è€Œä¸æ˜¯Â "),a("code",[t._v("current")]),t._v("Â å’ŒÂ "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘ä¸­ä½¿ç”¨çš„Â "),a("code",[t._v("child")]),t._v("Â å±æ€§è¿›è¡Œé“¾æ¥ã€‚"),a("br"),t._v("Dan Abramov ä¸ºå‰¯ä½œç”¨åˆ—è¡¨æä¾›äº†ä¸€ä¸ªç±»æ¯”ã€‚ä»–å–œæ¬¢å°†å®ƒæƒ³è±¡æˆä¸€æ£µåœ£è¯æ ‘ï¼Œã€Œåœ£è¯ç¯ã€å°†æ‰€æœ‰æœ‰æ•ˆèŠ‚ç‚¹æ†ç»‘åœ¨ä¸€èµ·ã€‚ä¸ºäº†ä½¿è¿™ä¸ªå¯è§†åŒ–ï¼Œè®©æˆ‘ä»¬æƒ³è±¡å¦‚ä¸‹çš„ Fiber èŠ‚ç‚¹æ ‘ï¼Œå…¶ä¸­æ ‡äº®çš„èŠ‚ç‚¹æœ‰ä¸€äº›è¦åšçš„å·¥ä½œã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„æ›´æ–°å¯¼è‡´Â "),a("code",[t._v("c2")]),t._v("Â è¢«æ’å…¥åˆ° DOM ä¸­ï¼Œ"),a("code",[t._v("d2")]),t._v("Â å’ŒÂ "),a("code",[t._v("c1")]),t._v("Â è¢«ç”¨äºæ›´æ”¹å±æ€§ï¼Œè€ŒÂ "),a("code",[t._v("b2")]),t._v("è¢«ç”¨äºè§¦å‘ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚å‰¯ä½œç”¨åˆ—è¡¨ä¼šå°†å®ƒä»¬é“¾æ¥åœ¨ä¸€èµ·ï¼Œä»¥ä¾¿ React ç¨åå¯ä»¥è·³è¿‡å…¶ä»–èŠ‚ç‚¹ï¼š"),a("br"),a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2019/webp/128853/1564754956620-8176f526-da4f-4099-b339-07e22b914820.webp#align=left&display=inline&height=357&originHeight=357&originWidth=475&size=0&status=done&width=475",alt:""}}),a("br"),t._v("å¯ä»¥çœ‹åˆ°å…·æœ‰å‰¯ä½œç”¨çš„èŠ‚ç‚¹æ˜¯å¦‚ä½•é“¾æ¥åœ¨ä¸€èµ·çš„ã€‚å½“éå†èŠ‚ç‚¹æ—¶ï¼ŒReact ä½¿ç”¨Â "),a("code",[t._v("firstEffect")]),t._v("Â æŒ‡é’ˆæ¥ç¡®å®šåˆ—è¡¨çš„å¼€å§‹ä½ç½®ã€‚æ‰€ä»¥ä¸Šé¢çš„å›¾è¡¨å¯ä»¥è¡¨ç¤ºä¸ºè¿™æ ·çš„çº¿æ€§åˆ—è¡¨ï¼š"),a("br"),a("img",{attrs:{src:"https://cdn.nlark.com/yuque/0/2019/webp/128853/1564754956572-87cc0b5c-77cb-4be0-915f-628f38e3f1c8.webp#align=left&display=inline&height=103&originHeight=103&originWidth=712&size=0&status=done&width=712",alt:""}}),a("br"),t._v("å¦‚æ‚¨æ‰€è§ï¼ŒReact æŒ‰ç…§ä»å­åˆ°çˆ¶çš„é¡ºåºåº”ç”¨å‰¯ä½œç”¨ã€‚\n"),a("a",{attrs:{name:"FEgIh"}})]),t._v(" "),a("h3",{attrs:{id:"fiber-æ ‘çš„æ ¹èŠ‚ç‚¹"}},[t._v("Fiber æ ‘çš„æ ¹èŠ‚ç‚¹")]),t._v(" "),a("p",[t._v("æ¯ä¸ª React åº”ç”¨ç¨‹åºéƒ½æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå……å½“å®¹å™¨çš„ DOM å…ƒç´ ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒæ˜¯å¸¦æœ‰ ID ä¸ºÂ "),a("code",[t._v("container")]),t._v("Â çš„Â "),a("code",[t._v("div")]),t._v("Â å…ƒç´ ã€‚React ä¸ºæ¯ä¸ªå®¹å™¨åˆ›å»ºä¸€ä¸ªÂ Fiber æ ¹å¯¹è±¡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨å¯¹ DOM å…ƒç´ çš„å¼•ç”¨æ¥è®¿é—®å®ƒï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" fiberRoot "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("query")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'#container'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_reactRootContainer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_internalRoot\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("è¿™ä¸ª Fiber æ ¹æ˜¯Reactä¿å­˜å¯¹ Fiber æ ‘çš„å¼•ç”¨çš„åœ°æ–¹ï¼Œå®ƒå­˜å‚¨åœ¨ Fiber æ ¹å¯¹è±¡çš„Â "),a("code",[t._v("current")]),t._v("Â å±æ€§ä¸­ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" hostRootFiberNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" fiberRoot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("Fiber æ ‘ä»¥ä¸€ä¸ªç‰¹æ®Šç±»å‹çš„ Fiber èŠ‚ç‚¹Â "),a("code",[t._v("HostRoot")]),t._v("Â å¼€å§‹ã€‚å®ƒåœ¨å†…éƒ¨åˆ›å»ºçš„ï¼Œå¹¶å……å½“æœ€é¡¶å±‚ç»„ä»¶çš„çˆ¶çº§ã€‚"),a("code",[t._v("HostRoot")]),t._v("Â èŠ‚ç‚¹å¯é€šè¿‡Â "),a("code",[t._v("stateNode")]),t._v("Â å±æ€§è¿”å›åˆ°Â "),a("code",[t._v("FiberRoot")]),t._v("ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[t._v("fiberRoot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("stateNode "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" fiberRoot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// true")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("ä½ å¯ä»¥é€šè¿‡ Fiber æ ¹è®¿é—®æœ€é¡¶å±‚çš„Â "),a("code",[t._v("HostRoot")]),t._v("Â èŠ‚ç‚¹æ¥æ¢ç´¢ Fiber æ ‘ï¼Œæˆ–è€…å¯ä»¥ä»ç»„ä»¶å®ä¾‹ä¸­è·å–å•ç‹¬çš„ Fiber èŠ‚ç‚¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[t._v("compInstance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_reactInternalFiber\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h3",{attrs:{id:"fiber-èŠ‚ç‚¹ç»“æ„"}},[t._v("Fiber èŠ‚ç‚¹ç»“æ„")]),t._v(" "),a("p",[t._v("ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸ºÂ "),a("code",[t._v("ClickCounter")]),t._v("Â ç»„ä»¶åˆ›å»ºçš„ Fiber èŠ‚ç‚¹çš„ç»“æ„")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stateNode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClickCounter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ClickCounter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    alternate"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    updateQueue"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    memoizedState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    pendingProps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    memoizedProps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    effectTag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    nextEffect"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("p",[t._v("ä»¥åŠÂ "),a("code",[t._v("span")]),t._v("Â DOM å…ƒç´ ï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    stateNode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ClickCounter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" ClickCounter"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    alternate"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    key"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    updateQueue"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    memoizedState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    pendingProps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    memoizedProps"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    tag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    effectTag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    nextEffect"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br")])]),a("p",[t._v("Fiber èŠ‚ç‚¹ä¸Šæœ‰å¾ˆå¤šå­—æ®µã€‚æˆ‘åœ¨å‰é¢çš„éƒ¨åˆ†ä¸­æè¿°äº†å­—æ®µÂ "),a("code",[t._v("alternate")]),t._v("ã€Â "),a("code",[t._v("effectTag")]),t._v("Â å’ŒÂ "),a("code",[t._v("nextEffect")]),t._v("Â çš„ç”¨é€”ã€‚ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹ä¸ºä»€ä¹ˆéœ€è¦å…¶ä»–å­—æ®µã€‚")]),t._v(" "),a("h4",{attrs:{id:"statenode"}},[t._v("stateNode")]),t._v(" "),a("p",[t._v("ä¿å­˜ç»„ä»¶çš„ç±»å®ä¾‹ã€DOM èŠ‚ç‚¹æˆ–ä¸ Fiber èŠ‚ç‚¹å…³è”çš„å…¶ä»– React å…ƒç´ ç±»å‹çš„å¼•ç”¨ã€‚æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºè¯¥å±æ€§ç”¨äºä¿æŒä¸ä¸€ä¸ª Fiber èŠ‚ç‚¹ç›¸å…³è”çš„å±€éƒ¨çŠ¶æ€ã€‚")]),t._v(" "),a("h4",{attrs:{id:"type"}},[t._v("type")]),t._v(" "),a("p",[t._v("å®šä¹‰æ­¤ Fiber èŠ‚ç‚¹çš„å‡½æ•°æˆ–ç±»ã€‚å¯¹äºç±»ç»„ä»¶ï¼Œå®ƒæŒ‡å‘æ„é€ å‡½æ•°ï¼Œå¯¹äº DOM å…ƒç´ ï¼Œå®ƒæŒ‡å®š HTML æ ‡è®°ã€‚æˆ‘ç»å¸¸ä½¿ç”¨è¿™ä¸ªå­—æ®µæ¥ç†è§£ Fiber èŠ‚ç‚¹ä¸å“ªä¸ªå…ƒç´ ç›¸å…³ã€‚")]),t._v(" "),a("h4",{attrs:{id:"tag"}},[t._v("tag")]),t._v(" "),a("p",[t._v("å®šä¹‰Â "),a("a",{attrs:{href:"https://github.com/facebook/react/blob/769b1f270e1251d9dbdce0fcbd9e92e502d059b8/packages/shared/ReactWorkTags.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Fiber çš„ç±»å‹"),a("OutboundLink")],1),t._v("ã€‚å®ƒåœ¨åè°ƒç®—æ³•ä¸­ç”¨äºç¡®å®šéœ€è¦å®Œæˆçš„å·¥ä½œã€‚å¦‚å‰æ‰€è¿°ï¼Œå·¥ä½œå–å†³äºReactå…ƒç´ çš„ç±»å‹ã€‚å‡½æ•°createFiberFromTypeAndPropså°† React å…ƒç´ æ˜ å°„åˆ°ç›¸åº”çš„ Fiber èŠ‚ç‚¹ç±»å‹ã€‚åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¸­ï¼Œ"),a("code",[t._v("ClickCounter")]),t._v("Â ç»„ä»¶çš„å±æ€§Â "),a("code",[t._v("tag")]),t._v("Â æ˜¯ 1ï¼Œè¡¨ç¤ºæ˜¯Â "),a("code",[t._v("ClassComponent")]),t._v("ï¼ˆç±»ç»„ä»¶ï¼‰ï¼Œè€ŒÂ "),a("code",[t._v("span")]),t._v("Â å…ƒç´ çš„å±æ€§Â "),a("code",[t._v("tag")]),t._v("Â æ˜¯ 5ï¼Œè¡¨ç¤ºæ˜¯Â "),a("code",[t._v("HostComponent")]),t._v("ï¼ˆå®¿ä¸»ç»„ä»¶ï¼‰ã€‚")]),t._v(" "),a("h4",{attrs:{id:"updatequeue"}},[t._v("updateQueue")]),t._v(" "),a("p",[t._v("çŠ¶æ€æ›´æ–°ã€å›è°ƒå’Œ DOM æ›´æ–°çš„é˜Ÿåˆ—ã€‚")]),t._v(" "),a("h4",{attrs:{id:"memoizedstate"}},[t._v("memoizedState")]),t._v(" "),a("p",[t._v("ç”¨äºåˆ›å»ºè¾“å‡ºçš„ Fiber çŠ¶æ€ã€‚å¤„ç†æ›´æ–°æ—¶ï¼Œå®ƒä¼šåæ˜ å½“å‰åœ¨å±å¹•ä¸Šå‘ˆç°çš„çŠ¶æ€ã€‚")]),t._v(" "),a("h4",{attrs:{id:"memoizedprops"}},[t._v("memoizedProps")]),t._v(" "),a("p",[t._v("åœ¨å‰ä¸€ä¸ªæ¸²æŸ“ä¸­ç”¨äºåˆ›å»ºè¾“å‡ºçš„ Fiber çš„ propsã€‚")]),t._v(" "),a("h4",{attrs:{id:"pendingprops"}},[t._v("pendingProps")]),t._v(" "),a("p",[t._v("å·²ä» React å…ƒç´ ä¸­çš„æ–°æ•°æ®æ›´æ–°å¹¶ä¸”éœ€è¦åº”ç”¨äºå­ç»„ä»¶æˆ– DOM å…ƒç´ çš„ propsã€‚")]),t._v(" "),a("h4",{attrs:{id:"key"}},[t._v("key")]),t._v(" "),a("p",[t._v("å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œå½“å…·æœ‰ä¸€ç»„å­å…ƒç´ çš„æ—¶å€™ï¼Œå¯å¸®åŠ© React ç¡®å®šå“ªäº›é¡¹å‘ç”Ÿäº†æ›´æ”¹ã€æ·»åŠ æˆ–åˆ é™¤ã€‚å®ƒä¸Â "),a("a",{attrs:{href:"https://reactjs.org/docs/lists-and-keys.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("æ­¤å¤„"),a("OutboundLink")],1),t._v("Â æè¿°çš„ React çš„ã€Œåˆ—è¡¨å’Œé”®ã€åŠŸèƒ½æœ‰å…³ã€‚æˆ‘åœ¨ä¸Šé¢çš„è§£é‡Šä¸­çœç•¥äº†ä¸€å †å­—æ®µã€‚ç‰¹åˆ«æ˜¯ï¼Œæˆ‘è·³è¿‡äº†æŒ‡é’ˆÂ "),a("code",[t._v("child")]),t._v("ã€"),a("code",[t._v("sibling")]),t._v("Â å’ŒÂ "),a("code",[t._v("return")]),t._v("ï¼Œå®ƒä»¬æ„æˆäº†æˆ‘åœ¨Â "),a("a",{attrs:{href:"https://medium.com/react-in-depth/the-how-and-why-on-reacts-usage-of-linked-list-in-fiber-67f1014d0eb7",target:"_blank",rel:"noopener noreferrer"}},[t._v("ä¸Šä¸€ç¯‡æ–‡ç« "),a("OutboundLink")],1),t._v("Â ä¸­æè¿°çš„æ ‘æ•°æ®ç»“æ„ã€‚ä»¥åŠä¸“å±äº Scheduler çš„ expirationTimeï¼ŒchildExpirationTime å’Œ mode ç­‰å­—æ®µç±»åˆ«ã€‚")]),t._v(" "),a("h2",{attrs:{id:"é€šç”¨ç®—æ³•"}},[t._v("é€šç”¨ç®—æ³•")]),t._v(" "),a("p",[t._v("React åœ¨ä¸¤ä¸ªä¸»è¦é˜¶æ®µæ‰§è¡Œå·¥ä½œï¼š"),a("code",[t._v("render")]),t._v("Â å’ŒÂ "),a("code",[t._v("commit")]),t._v("ã€‚"),a("br"),t._v("åœ¨ç¬¬ä¸€ä¸ªÂ "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µï¼ŒReact é€šè¿‡Â "),a("code",[t._v("setUpdate")]),t._v("Â æˆ–Â "),a("code",[t._v("React.render")]),t._v("Â è®¡åˆ’æ€§çš„æ›´æ–°ç»„ä»¶ï¼Œå¹¶ç¡®å®šéœ€è¦åœ¨ UI ä¸­æ›´æ–°çš„å†…å®¹ã€‚å¦‚æœæ˜¯åˆå§‹æ¸²æŸ“ï¼ŒReact ä¼šä¸ºÂ "),a("code",[t._v("render")]),t._v("Â æ–¹æ³•è¿”å›çš„æ¯ä¸ªå…ƒç´ åˆ›å»ºä¸€ä¸ªæ–°çš„ Fiber èŠ‚ç‚¹ã€‚åœ¨åç»­æ›´æ–°ä¸­ï¼Œç°æœ‰ React å…ƒç´ çš„ Fiber èŠ‚ç‚¹å°†è¢«é‡å¤ä½¿ç”¨å’Œæ›´æ–°ã€‚"),a("strong",[t._v("è¿™ä¸€é˜¶æ®µæ˜¯ä¸ºäº†å¾—åˆ°æ ‡è®°äº†å‰¯ä½œç”¨çš„ Fiber èŠ‚ç‚¹æ ‘")]),t._v("ã€‚å‰¯ä½œç”¨æè¿°äº†åœ¨ä¸‹ä¸€ä¸ª"),a("code",[t._v("commit")]),t._v("é˜¶æ®µéœ€è¦å®Œæˆçš„å·¥ä½œã€‚åœ¨å½“å‰é˜¶æ®µï¼ŒReactæŒæœ‰æ ‡è®°äº†å‰¯ä½œç”¨çš„ Fiber æ ‘å¹¶å°†å…¶åº”ç”¨äºå®ä¾‹ã€‚å®ƒéå†å‰¯ä½œç”¨åˆ—è¡¨ã€æ‰§è¡Œ DOM æ›´æ–°å’Œç”¨æˆ·å¯è§çš„å…¶ä»–æ›´æ”¹ã€‚"),a("br"),t._v("**æˆ‘ä»¬éœ€è¦é‡ç‚¹ç†è§£çš„æ˜¯ï¼Œç¬¬ä¸€ä¸ªÂ "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µçš„å·¥ä½œæ˜¯å¯ä»¥å¼‚æ­¥æ‰§è¡Œçš„ã€‚**React å¯ä»¥æ ¹æ®å¯ç”¨æ—¶é—´ç‰‡æ¥å¤„ç†ä¸€ä¸ªæˆ–å¤šä¸ª Fiber èŠ‚ç‚¹ï¼Œç„¶ååœä¸‹æ¥æš‚å­˜å·²å®Œæˆçš„å·¥ä½œï¼Œå¹¶è½¬è€Œå»å¤„ç†æŸäº›äº‹ä»¶ï¼Œæ¥ç€å®ƒå†ä»å®ƒåœæ­¢çš„åœ°æ–¹ç»§ç»­æ‰§è¡Œã€‚ä½†æœ‰æ—¶å€™ï¼Œå®ƒå¯èƒ½éœ€è¦ä¸¢å¼ƒå®Œæˆçš„å·¥ä½œå¹¶å†æ¬¡ä»é¡¶éƒ¨å¼€å§‹ã€‚ç”±äºåœ¨æ­¤é˜¶æ®µæ‰§è¡Œçš„å·¥ä½œä¸ä¼šå¯¼è‡´ä»»ä½•ç”¨æˆ·å¯è§çš„æ›´æ”¹ï¼ˆå¦‚ DOM æ›´æ–°ï¼‰ï¼Œå› æ­¤æš‚åœè¡Œä¸ºæ‰æœ‰äº†æ„ä¹‰ã€‚**ä¸ä¹‹ç›¸åçš„æ˜¯ï¼Œåç»­Â "),a("code",[t._v("commit")]),t._v("Â é˜¶æ®µå§‹ç»ˆæ˜¯åŒæ­¥çš„ã€‚**è¿™æ˜¯å› ä¸ºåœ¨æ­¤é˜¶æ®µæ‰§è¡Œçš„å·¥ä½œä¼šå¯¼è‡´ç”¨æˆ·å¯è§çš„å˜åŒ–ï¼Œä¾‹å¦‚ DOM æ›´æ–°ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ React éœ€è¦åœ¨ä¸€æ¬¡å•ä¸€è¿‡ç¨‹ä¸­å®Œæˆè¿™äº›æ›´æ–°ã€‚"),a("br"),t._v("React è¦åšçš„ä¸€ç§å·¥ä½œå°±æ˜¯è°ƒç”¨ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚ä¸€äº›æ–¹æ³•æ˜¯åœ¨Â "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µè°ƒç”¨çš„ï¼Œè€Œå¦ä¸€äº›æ–¹æ³•åˆ™æ˜¯åœ¨Â "),a("code",[t._v("commit")]),t._v("Â é˜¶æ®µè°ƒç”¨ã€‚è¿™æ˜¯åœ¨ç¬¬ä¸€ä¸ªÂ "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µè°ƒç”¨çš„ç”Ÿå‘½å‘¨æœŸåˆ—è¡¨ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("[UNSAFE_]componentWillMountï¼ˆå¼ƒç”¨ï¼‰"),a("br")]),t._v(" "),a("li",[t._v("[UNSAFE_]componentWillReceivePropsï¼ˆå¼ƒç”¨ï¼‰"),a("br")]),t._v(" "),a("li",[t._v("getDerivedStateFromProps"),a("br")]),t._v(" "),a("li",[t._v("shouldComponentUpdate"),a("br")]),t._v(" "),a("li",[t._v("[UNSAFE_]componentWillUpdateï¼ˆå¼ƒç”¨ï¼‰"),a("br")]),t._v(" "),a("li",[t._v("render"),a("br")])]),t._v(" "),a("p",[t._v("æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„ï¼Œä»ç‰ˆæœ¬ 16.3 å¼€å§‹ï¼Œåœ¨Â "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µæ‰§è¡Œçš„ä¸€äº›ä¿ç•™çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è¢«æ ‡è®°ä¸ºÂ "),a("code",[t._v("UNSAFE")]),t._v("ï¼Œå®ƒä»¬ç°åœ¨åœ¨æ–‡æ¡£ä¸­è¢«ç§°ä¸ºé—ç•™ç”Ÿå‘½å‘¨æœŸã€‚å®ƒä»¬å°†åœ¨æœªæ¥çš„ 16.x å‘å¸ƒç‰ˆæœ¬ä¸­å¼ƒç”¨ï¼Œè€Œæ²¡æœ‰Â "),a("code",[t._v("UNSAFE")]),t._v("Â å‰ç¼€çš„æ–¹æ³•å°†åœ¨ 17.0 ä¸­ç§»é™¤ã€‚æ‚¨å¯ä»¥åœ¨Â "),a("a",{attrs:{href:"https://reactjs.org/blog/2018/03/27/update-on-async-rendering.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("æ­¤å¤„"),a("OutboundLink")],1),t._v("Â è¯¦ç»†äº†è§£è¿™äº›æ›´æ”¹ä»¥åŠå»ºè®®çš„è¿ç§»è·¯å¾„ã€‚"),a("br"),t._v("é‚£ä¹ˆè¿™ä¹ˆåšçš„ç›®çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ"),a("br"),t._v("å¥½å§ï¼Œæˆ‘ä»¬åˆšåˆšäº†è§£åˆ°ï¼Œå› ä¸ºÂ "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µä¸ä¼šäº§ç”Ÿåƒ DOM æ›´æ–°è¿™æ ·çš„å‰¯ä½œç”¨ï¼Œæ‰€ä»¥ React å¯ä»¥å¼‚æ­¥å¤„ç†ç»„ä»¶çš„å¼‚æ­¥æ›´æ–°ï¼ˆç”šè‡³å¯èƒ½åœ¨å¤šä¸ªçº¿ç¨‹ä¸­æ‰§è¡Œï¼‰ã€‚ä½†æ˜¯ï¼Œæ ‡æœ‰ UNSAFE çš„ç”Ÿå‘½å‘¨æœŸç»å¸¸è¢«è¯¯è§£å’Œæ»¥ç”¨ã€‚å¼€å‘äººå‘˜å€¾å‘äºå°†å¸¦æœ‰å‰¯ä½œç”¨çš„ä»£ç æ”¾åœ¨è¿™äº›æ–¹æ³•ä¸­ï¼Œè¿™å¯èƒ½ä¼šå¯¼è‡´æ–°çš„å¼‚æ­¥æ¸²æŸ“æ–¹æ³•å‡ºç°é—®é¢˜ã€‚è™½ç„¶åªæœ‰æ²¡æœ‰ UNSAFE å‰ç¼€çš„å¯¹åº”æ–¹æ³•å°†è¢«åˆ é™¤ï¼Œä½†å®ƒä»¬ä»å¯èƒ½åœ¨å³å°†å‡ºç°çš„å¹¶å‘æ¨¡å¼ï¼ˆæ‚¨å¯ä»¥é€‰æ‹©é€€å‡ºï¼‰ä¸­å¼•èµ·é—®é¢˜ã€‚"),a("br"),t._v("æ¥ä¸‹æ¥ç½—åˆ—çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•æ˜¯åœ¨ç¬¬äºŒä¸ªÂ "),a("code",[t._v("commit")]),t._v("Â é˜¶æ®µæ‰§è¡Œçš„ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("getSnapshotBeforeUpdate"),a("br")]),t._v(" "),a("li",[t._v("componentDidMount"),a("br")]),t._v(" "),a("li",[t._v("componentDidUpdate"),a("br")]),t._v(" "),a("li",[t._v("componentWillUnmount"),a("br")])]),t._v(" "),a("p",[t._v("å› ä¸ºè¿™äº›æ–¹æ³•éƒ½åœ¨åŒæ­¥çš„Â "),a("code",[t._v("commit")]),t._v("Â é˜¶æ®µæ‰§è¡Œï¼Œä»–ä»¬å¯èƒ½ä¼šåŒ…å«å‰¯ä½œç”¨ï¼Œå¹¶å¯¹ DOM è¿›è¡Œä¸€äº›æ“ä½œã€‚"),a("br"),t._v("è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº†å……åˆ†çš„èƒŒæ™¯çŸ¥è¯†ï¼Œä¸‹é¢æˆ‘ä»¬å¯ä»¥çœ‹ä¸‹ç”¨æ¥éå†æ ‘å’Œæ‰§è¡Œä¸€äº›å·¥ä½œçš„é€šç”¨ç®—æ³•ã€‚")]),t._v(" "),a("h3",{attrs:{id:"render-é˜¶æ®µ"}},[t._v("Render é˜¶æ®µ")]),t._v(" "),a("p",[t._v("åè°ƒç®—æ³•å§‹ç»ˆä½¿ç”¨Â renderRoot å‡½æ•°ä»æœ€é¡¶å±‚çš„Â "),a("code",[t._v("HostRoot")]),t._v("Â èŠ‚ç‚¹å¼€å§‹ã€‚ä¸è¿‡ï¼ŒReact ä¼šç•¥è¿‡å·²ç»å¤„ç†è¿‡çš„ Fiber èŠ‚ç‚¹ï¼Œç›´åˆ°æ‰¾åˆ°æœªå®Œæˆå·¥ä½œçš„èŠ‚ç‚¹ã€‚ä¾‹å¦‚ï¼Œå¦‚æœåœ¨ç»„ä»¶æ ‘ä¸­çš„æ·±å±‚ç»„ä»¶ä¸­è°ƒç”¨Â "),a("code",[t._v("setState")]),t._v("Â æ–¹æ³•ï¼Œåˆ™ React å°†ä»é¡¶éƒ¨å¼€å§‹ï¼Œä½†ä¼šå¿«é€Ÿè·³è¿‡å„ä¸ªçˆ¶é¡¹ï¼Œç›´åˆ°å®ƒåˆ°è¾¾è°ƒç”¨äº†Â "),a("code",[t._v("setState")]),t._v("æ–¹æ³•çš„ç»„ä»¶ã€‚")]),t._v(" "),a("h3",{attrs:{id:"å·¥ä½œå¾ªç¯çš„ä¸»è¦æ­¥éª¤"}},[t._v("å·¥ä½œå¾ªç¯çš„ä¸»è¦æ­¥éª¤")]),t._v(" "),a("p",[t._v("æ‰€æœ‰çš„ Fiber èŠ‚ç‚¹éƒ½ä¼šåœ¨å·¥ä½œå¾ªç¯ä¸­è¿›è¡Œå¤„ç†ã€‚å¦‚ä¸‹æ˜¯è¯¥å¾ªç¯çš„åŒæ­¥éƒ¨åˆ†çš„å®ç°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("workLoop")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("isYieldy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("isYieldy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextUnitOfWork "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      nextUnitOfWork "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("performUnitOfWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextUnitOfWork"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[t._v("åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œ"),a("code",[t._v("nextUnitOfWork")]),t._v("Â æŒæœ‰Â "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘ä¸­çš„ Fiber èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ ‘æœ‰ä¸€äº›å·¥ä½œè¦åšã€‚å½“ React éå† Fiber æ ‘æ—¶ï¼Œå®ƒä¼šä½¿ç”¨è¿™ä¸ªå˜é‡æ¥çŸ¥æ™“æ˜¯å¦æœ‰ä»»ä½•å…¶ä»– Fiber èŠ‚ç‚¹å…·æœ‰æœªå®Œæˆçš„å·¥ä½œã€‚å¤„ç†è¿‡å½“å‰ Fiber åï¼Œå˜é‡å°†æŒæœ‰æ ‘ä¸­ä¸‹ä¸€ä¸ª Fiber èŠ‚ç‚¹çš„å¼•ç”¨æˆ– nullã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒReact é€€å‡ºå·¥ä½œå¾ªç¯å¹¶å‡†å¤‡å¥½æäº¤æ›´æ”¹ã€‚"),a("br"),t._v("éå†æ ‘ã€åˆå§‹åŒ–æˆ–å®Œæˆå·¥ä½œä¸»è¦ç”¨åˆ° 4 ä¸ªå‡½æ•°ï¼š")]),t._v(" "),a("ul",[a("li",[t._v("performUnitOfWork")]),t._v(" "),a("li",[t._v("beginWork")]),t._v(" "),a("li",[t._v("completeUnitOfWork")]),t._v(" "),a("li",[t._v("completeWork")])]),t._v(" "),a("p",[t._v("ä¸ºäº†æ¼”ç¤ºä»–ä»¬çš„ä½¿ç”¨æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹å¦‚ä¸‹å±•ç¤ºçš„éå† Fiber æ ‘çš„åŠ¨ç”»ã€‚æˆ‘å·²ç»åœ¨æ¼”ç¤ºä¸­ä½¿ç”¨äº†è¿™äº›å‡½æ•°çš„ç®€åŒ–å®ç°ã€‚æ¯ä¸ªå‡½æ•°éƒ½éœ€è¦å¯¹ä¸€ä¸ª Fiber èŠ‚ç‚¹è¿›è¡Œå¤„ç†ï¼Œå½“ React ä»æ ‘ä¸Šä¸‹æ¥æ—¶ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°å½“å‰æ´»åŠ¨çš„ Fiber èŠ‚ç‚¹å‘ç”Ÿäº†å˜åŒ–ã€‚ä»è§†é¢‘ä¸­æˆ‘ä»¬å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ç®—æ³•å¦‚ä½•ä»ä¸€ä¸ªåˆ†æ”¯è½¬åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ã€‚å®ƒé¦–å…ˆå®Œæˆå­èŠ‚ç‚¹çš„å·¥ä½œï¼Œç„¶åæ‰è½¬ç§»åˆ°çˆ¶èŠ‚ç‚¹è¿›è¡Œå¤„ç†ã€‚"),a("br"),a("img",{attrs:{src:"https://user-gold-cdn.xitu.io/2018/12/3/1677442376e53cda?imageslim#align=left&display=inline&height=420&originHeight=420&originWidth=780&status=uploading&width=780",alt:""}}),a("br"),a("em",[t._v("æ³¨æ„ï¼Œå‚ç›´æ–¹å‘çš„è¿çº¿è¡¨ç¤ºåŒå±‚å…³ç³»ï¼Œè€ŒæŠ˜çº¿è¿æ¥è¡¨ç¤ºçˆ¶å­å…³ç³»ï¼Œä¾‹å¦‚ï¼Œ"),a("code",[t._v("b1")]),t._v("Â æ²¡æœ‰å­èŠ‚ç‚¹ï¼Œè€ŒÂ "),a("code",[t._v("b2")]),t._v("æœ‰ä¸€ä¸ªå­èŠ‚ç‚¹Â "),a("code",[t._v("c1")]),t._v("ã€‚")]),a("br"),t._v("åœ¨è¿™ä¸ªÂ "),a("a",{attrs:{href:"https://vimeo.com/302222454",target:"_blank",rel:"noopener noreferrer"}},[t._v("è§†é¢‘"),a("OutboundLink")],1),t._v("Â ä¸­æˆ‘ä»¬å¯ä»¥æš‚åœæ’­æ”¾å¹¶æ£€æŸ¥å½“å‰èŠ‚ç‚¹å’Œå‡½æ•°çš„çŠ¶æ€ã€‚ä»æ¦‚å¿µä¸Šè®²ï¼Œä½ å¯ä»¥å°†ã€Œå¼€å§‹ã€è§†ä¸ºã€Œè¿›å…¥ã€ä¸€ä¸ªç»„ä»¶ï¼Œå¹¶å°†ã€Œå®Œæˆã€è§†ä¸ºã€Œç¦»å¼€ã€å®ƒã€‚åœ¨è§£é‡Šè¿™äº›å‡½æ•°çš„ä½œç”¨æ—¶ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨Â "),a("a",{attrs:{href:"https://stackblitz.com/edit/js-ntqfil%3Ffile=index.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("è¿™é‡Œ"),a("OutboundLink")],1),t._v("Â ä½¿ç”¨ç¤ºä¾‹å’Œå®ç°ã€‚"),a("br"),t._v("æˆ‘ä»¬é¦–å…ˆå¼€å§‹ç ”ç©¶Â "),a("code",[t._v("performUnitOfWork")]),t._v("Â å’ŒÂ "),a("code",[t._v("beginWork")]),t._v("Â è¿™ä¸¤ä¸ªå‡½æ•°ï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("performUnitOfWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("workInProgress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" next "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("beginWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("next "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        next "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeUnitOfWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" next"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("beginWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("workInProgress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'work performed for '")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("child"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("p",[t._v("å‡½æ•°Â "),a("code",[t._v("performUnitOfWork")]),t._v("Â ä»Â "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘æ¥æ”¶ä¸€ä¸ª Fiber èŠ‚ç‚¹ï¼Œå¹¶é€šè¿‡è°ƒç”¨Â "),a("code",[t._v("beginWork")]),t._v("å‡½æ•°å¯åŠ¨å·¥ä½œã€‚è¿™ä¸ªå‡½æ•°å°†å¯åŠ¨æ‰€æœ‰ Fiber æ‰§è¡Œå·¥ä½œæ‰€éœ€è¦çš„æ´»åŠ¨ã€‚å‡ºäºæ¼”ç¤ºçš„ç›®çš„ï¼Œæˆ‘ä»¬åª log å‡º Fiber èŠ‚ç‚¹çš„åç§°æ¥è¡¨ç¤ºå·¥ä½œå·²ç»å®Œæˆã€‚"),a("strong",[t._v("å‡½æ•°Â "),a("code",[t._v("beginWork")]),t._v("Â å§‹ç»ˆè¿”å›æŒ‡å‘è¦åœ¨å¾ªç¯ä¸­å¤„ç†çš„ä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹çš„æŒ‡é’ˆæˆ– nullã€‚")]),a("br"),t._v("å¦‚æœæœ‰ä¸‹ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œå®ƒå°†è¢«èµ‹å€¼ç»™Â "),a("code",[t._v("workLoop")]),t._v("Â å‡½æ•°ä¸­çš„å˜é‡Â "),a("code",[t._v("nextUnitOfWork")]),t._v("ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ²¡æœ‰å­èŠ‚ç‚¹ï¼ŒReact çŸ¥é“å®ƒåˆ°è¾¾äº†åˆ†æ”¯çš„æœ«å°¾ï¼Œå› æ­¤å®ƒå¯ä»¥å®Œæˆå½“å‰èŠ‚ç‚¹ã€‚**ä¸€æ—¦èŠ‚ç‚¹å®Œæˆï¼Œå®ƒå°†éœ€è¦ä¸ºåŒå±‚çš„å…¶ä»–èŠ‚ç‚¹æ‰§è¡Œå·¥ä½œï¼Œå¹¶åœ¨å®Œæˆåå›æº¯åˆ°çˆ¶èŠ‚ç‚¹ã€‚**è¿™æ˜¯Â "),a("code",[t._v("completeUnitOfWork")]),t._v("Â å‡½æ•°æ‰§è¡Œçš„ä»£ç ï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeUnitOfWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("workInProgress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" returnFiber "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("return"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" siblingFiber "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("sibling"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        nextUnitOfWork "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("siblingFiber "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If there is a sibling, return it")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// to perform work for this sibling")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" siblingFiber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("returnFiber "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// If there's no more work in this returnFiber,")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// continue the loop to complete the parent.")]),t._v("\n            workInProgress "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" returnFiber"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("continue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// We've reached the root.")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("completeWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("workInProgress")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'work completed for '")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" workInProgress"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br")])]),a("p",[t._v("ä½ å¯ä»¥çœ‹åˆ°å‡½æ•°çš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªå¤§çš„Â "),a("code",[t._v("while")]),t._v("Â çš„å¾ªç¯ã€‚å½“Â "),a("code",[t._v("workInProgress")]),t._v("Â èŠ‚ç‚¹æ²¡æœ‰å­èŠ‚ç‚¹æ—¶ï¼ŒReact ä¼šè¿›å…¥æ­¤å‡½æ•°ã€‚å®Œæˆå½“å‰ Fiber èŠ‚ç‚¹çš„å·¥ä½œåï¼Œå®ƒå°±ä¼šæ£€æŸ¥æ˜¯å¦æœ‰åŒå±‚èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾çš„åˆ°ï¼ŒReact é€€å‡ºè¯¥å‡½æ•°å¹¶è¿”å›æŒ‡å‘è¯¥åŒå±‚èŠ‚ç‚¹çš„æŒ‡é’ˆã€‚å®ƒå°†è¢«èµ‹å€¼ç»™Â "),a("code",[t._v("nextUnitOfWork")]),t._v("Â å˜é‡ï¼ŒReactå°†ä»è¿™ä¸ªèŠ‚ç‚¹å¼€å§‹æ‰§è¡Œåˆ†æ”¯çš„å·¥ä½œã€‚æˆ‘ä»¬éœ€è¦ç€é‡ç†è§£çš„æ˜¯ï¼Œåœ¨å½“å‰èŠ‚ç‚¹ä¸Šï¼ŒReact åªå®Œæˆäº†å‰é¢çš„åŒå±‚èŠ‚ç‚¹çš„å·¥ä½œã€‚å®ƒå°šæœªå®Œæˆçˆ¶èŠ‚ç‚¹çš„å·¥ä½œã€‚"),a("strong",[t._v("åªæœ‰åœ¨å®Œæˆä»¥å­èŠ‚ç‚¹å¼€å§‹çš„æ‰€æœ‰åˆ†æ”¯åï¼Œæ‰èƒ½å®Œæˆçˆ¶èŠ‚ç‚¹å’Œå›æº¯çš„å·¥ä½œã€‚")]),a("br"),t._v("ä»å®ç°ä¸­å¯ä»¥çœ‹å‡ºï¼Œ"),a("code",[t._v("performUnitOfWork")]),t._v("Â å’ŒÂ "),a("code",[t._v("completeUnitOfWork")]),t._v("Â ä¸»è¦ç”¨äºè¿­ä»£ç›®çš„ï¼Œè€Œä¸»è¦æ´»åŠ¨åˆ™åœ¨Â "),a("code",[t._v("beginWork")]),t._v("Â å’ŒÂ "),a("code",[t._v("completeWork")]),t._v("Â å‡½æ•°ä¸­è¿›è¡Œã€‚åœ¨åç»­çš„ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†äº†è§£éšç€ React è¿›å…¥Â "),a("code",[t._v("beginWork")]),t._v("Â å’ŒÂ "),a("code",[t._v("completeWork")]),t._v("Â å‡½æ•°ï¼Œ"),a("code",[t._v("ClickCounter")]),t._v("Â ç»„ä»¶å’ŒÂ "),a("code",[t._v("span")]),t._v("Â èŠ‚ç‚¹ä¼šå‘ç”Ÿä»€ä¹ˆã€‚")]),t._v(" "),a("h3",{attrs:{id:"commit-é˜¶æ®µ"}},[a("code",[t._v("commit")]),t._v("Â é˜¶æ®µ")]),t._v(" "),a("p",[t._v("è¿™ä¸€é˜¶æ®µä»å‡½æ•°Â completeRootÂ å¼€å§‹ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒReact æ›´æ–° DOM å¹¶è°ƒç”¨å˜æ›´ç”Ÿå‘½å‘¨æœŸä¹‹å‰åŠä¹‹åæ–¹æ³•çš„åœ°æ–¹ã€‚"),a("br"),t._v("å½“ React è¿›å…¥è¿™ä¸ªé˜¶æ®µæ—¶ï¼Œå®ƒæœ‰ 2 æ£µæ ‘å’Œå‰¯ä½œç”¨åˆ—è¡¨ã€‚ç¬¬ä¸€ä¸ªæ ‘è¡¨ç¤ºå½“å‰åœ¨å±å¹•ä¸Šæ¸²æŸ“çš„çŠ¶æ€ï¼Œç„¶ååœ¨Â "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µä¼šæ„å»ºä¸€ä¸ªå¤‡ç”¨æ ‘ã€‚å®ƒåœ¨æºä»£ç ä¸­ç§°ä¸ºÂ "),a("code",[t._v("finishedWork")]),t._v("Â æˆ–Â "),a("code",[t._v("workInProgress")]),t._v("ï¼Œè¡¨ç¤ºéœ€è¦æ˜ å°„åˆ°å±å¹•ä¸Šçš„çŠ¶æ€ã€‚æ­¤å¤‡ç”¨æ ‘ä¼šç”¨ç±»ä¼¼çš„æ–¹æ³•é€šè¿‡Â "),a("code",[t._v("child")]),t._v("Â å’ŒÂ "),a("code",[t._v("sibling")]),t._v("Â æŒ‡é’ˆé“¾æ¥åˆ°Â "),a("code",[t._v("current")]),t._v("Â æ ‘ã€‚"),a("br"),t._v("ç„¶åï¼Œæœ‰ä¸€ä¸ªå‰¯ä½œç”¨åˆ—è¡¨ -- å®ƒæ˜¯Â "),a("code",[t._v("finishedWork")]),t._v("Â æ ‘çš„èŠ‚ç‚¹å­é›†ï¼Œé€šè¿‡Â "),a("code",[t._v("nextEffect")]),t._v("Â æŒ‡é’ˆè¿›è¡Œé“¾æ¥ã€‚éœ€è¦è®°ä½çš„æ˜¯ï¼Œå‰¯ä½œç”¨åˆ—è¡¨æ˜¯è¿è¡ŒÂ "),a("code",[t._v("render")]),t._v("Â é˜¶æ®µçš„_ç»“æœ_ã€‚æ¸²æŸ“çš„é‡ç‚¹å°±æ˜¯ç¡®å®šéœ€è¦æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤çš„èŠ‚ç‚¹ï¼Œä»¥åŠå“ªäº›ç»„ä»¶éœ€è¦è°ƒç”¨å…¶ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚è¿™å°±æ˜¯å‰¯ä½œç”¨åˆ—è¡¨å‘Šè¯‰æˆ‘ä»¬çš„å†…å®¹ï¼Œ"),a("strong",[t._v("å®ƒé¡µæ­£æ˜¯åœ¨Â "),a("code",[t._v("commit")]),t._v("Â é˜¶æ®µè¿­ä»£çš„èŠ‚ç‚¹é›†åˆã€‚")]),a("br"),a("em",[t._v("å‡ºäºè°ƒè¯•ç›®çš„ï¼Œå¯ä»¥é€šè¿‡ Fiber æ ¹çš„å±æ€§Â "),a("code",[t._v("current")]),t._v("è®¿é—®Â "),a("code",[t._v("current")]),t._v("Â æ ‘ã€‚å¯ä»¥é€šè¿‡Â "),a("code",[t._v("current")]),t._v("Â æ ‘ä¸­Â "),a("code",[t._v("HostFiber")]),t._v("Â èŠ‚ç‚¹çš„Â "),a("code",[t._v("alternate")]),t._v("Â å±æ€§è®¿é—®Â "),a("code",[t._v("finishedWork")]),t._v("Â æ ‘ã€‚")]),a("br"),t._v("åœ¨Â "),a("code",[t._v("commit")]),t._v("Â é˜¶æ®µè¿è¡Œçš„ä¸»è¦å‡½æ•°æ˜¯Â commitRoot ã€‚å®ƒæ‰§è¡Œå¦‚ä¸‹ä¸‹æ“ä½œï¼š")]),t._v(" "),a("ul",[a("li",[t._v("åœ¨æ ‡è®°ä¸ºÂ "),a("code",[t._v("Snapshot")]),t._v("Â å‰¯ä½œç”¨çš„èŠ‚ç‚¹ä¸Šè°ƒç”¨Â "),a("code",[t._v("getSnapshotBeforeUpdate")]),t._v("Â ç”Ÿå‘½å‘¨æœŸ"),a("br")]),t._v(" "),a("li",[t._v("åœ¨æ ‡è®°ä¸ºÂ "),a("code",[t._v("Deletion")]),t._v("Â å‰¯ä½œç”¨çš„èŠ‚ç‚¹ä¸Šè°ƒç”¨Â "),a("code",[t._v("componentWillUnmount")]),t._v("Â ç”Ÿå‘½å‘¨æœŸ"),a("br")]),t._v(" "),a("li",[t._v("æ‰§è¡Œæ‰€æœ‰ DOM æ’å…¥ã€æ›´æ–°ã€åˆ é™¤æ“ä½œ"),a("br")]),t._v(" "),a("li",[t._v("å°†Â "),a("code",[t._v("finishedWork")]),t._v("Â æ ‘è®¾ç½®ä¸º current"),a("br")]),t._v(" "),a("li",[t._v("åœ¨æ ‡è®°ä¸ºÂ "),a("code",[t._v("Placement")]),t._v("Â å‰¯ä½œç”¨çš„èŠ‚ç‚¹ä¸Šè°ƒç”¨Â "),a("code",[t._v("componentDidMount")]),t._v("Â ç”Ÿå‘½å‘¨æœŸ"),a("br")]),t._v(" "),a("li",[t._v("åœ¨æ ‡è®°ä¸ºÂ "),a("code",[t._v("Update")]),t._v("Â å‰¯ä½œç”¨çš„èŠ‚ç‚¹ä¸Šè°ƒç”¨Â "),a("code",[t._v("componentDidUpdate")]),t._v("Â ç”Ÿå‘½å‘¨æœŸ"),a("br")])]),t._v(" "),a("p",[t._v("åœ¨è°ƒç”¨å˜æ›´å‰æ–¹æ³•Â "),a("code",[t._v("getSnapshotBeforeUpdate")]),t._v("Â ä¹‹åï¼ŒReact ä¼šåœ¨æ ‘ä¸­æäº¤æ‰€æœ‰å‰¯ä½œç”¨ï¼Œè¿™ä¼šé€šè¿‡ä¸¤æ³¢æ“ä½œæ¥å®Œæˆã€‚ç¬¬ä¸€æ³¢æ‰§è¡Œæ‰€æœ‰ DOMï¼ˆå®¿ä¸»ï¼‰æ’å…¥ã€æ›´æ–°ã€åˆ é™¤å’Œ ref å¸è½½ã€‚ç„¶å React å°†Â "),a("code",[t._v("finishedWork")]),t._v("Â æ ‘èµ‹å€¼ç»™Â "),a("code",[t._v("FiberRoot")]),t._v("ï¼Œå°†Â "),a("code",[t._v("workInProgress")]),t._v("Â æ ‘æ ‡è®°ä¸ºÂ "),a("code",[t._v("current")]),t._v("Â æ ‘ã€‚è¿™æ˜¯åœ¨æäº¤é˜¶æ®µçš„ç¬¬ä¸€æ³¢ä¹‹åã€ç¬¬äºŒæ³¢ä¹‹å‰å®Œæˆçš„ï¼Œå› æ­¤åœ¨Â "),a("code",[t._v("componentWillUnmount")]),t._v("Â ä¸­å‰ä¸€ä¸ªæ ‘ä»ç„¶æ˜¯ currentï¼Œåœ¨Â "),a("code",[t._v("componentDidMount/Update")]),t._v("Â æœŸé—´å·²å®Œæˆå·¥ä½œæ˜¯ currentã€‚åœ¨ç¬¬äºŒæ³¢ï¼ŒReact è°ƒç”¨æ‰€æœ‰å…¶ä»–ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å’Œå¼•ç”¨å›è°ƒã€‚è¿™äº›æ–¹æ³•å•ç‹¬ä¼ é€’æ‰§è¡Œï¼Œä»è€Œä¿è¯æ•´ä¸ªæ ‘ä¸­çš„æ‰€æœ‰æ”¾ç½®ã€æ›´æ–°å’Œåˆ é™¤èƒ½å¤Ÿè¢«è§¦å‘æ‰§è¡Œã€‚"),a("br"),t._v("ä»¥ä¸‹æ˜¯è¿è¡Œä¸Šè¿°æ­¥éª¤çš„å‡½æ•°çš„è¦ç‚¹ï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitRoot")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" finishedWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitBeforeMutationLifecycles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitAllHostEffects")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" finishedWork"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitAllLifeCycles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[t._v("è¿™äº›å­å‡½æ•°ä¸­éƒ½å®ç°äº†ä¸€ä¸ªå¾ªç¯ï¼Œè¯¥å¾ªç¯éå†å‰¯ä½œç”¨åˆ—è¡¨å¹¶æ£€æŸ¥å‰¯ä½œç”¨çš„ç±»å‹ã€‚å½“å®ƒæ‰¾åˆ°ä¸å‡½æ•°ç›®çš„ç›¸å…³çš„å‰¯ä½œç”¨æ—¶ï¼Œå°±ä¼šæ‰§è¡Œã€‚")]),t._v(" "),a("h3",{attrs:{id:"æ›´æ–°å‰çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"}},[t._v("æ›´æ–°å‰çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•")]),t._v(" "),a("p",[t._v("ä¾‹å¦‚ï¼Œè¿™æ˜¯åœ¨å‰¯ä½œç”¨æ ‘ä¸Šéå†å¹¶æ£€æŸ¥èŠ‚ç‚¹æ˜¯å¦å…·æœ‰Â "),a("code",[t._v("Snapshot")]),t._v("Â å‰¯ä½œç”¨çš„ä»£ç ï¼š")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitBeforeMutationLifecycles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextEffect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" effectTag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("effectTag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("effectTag "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&")]),t._v(" Snapshot"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" current "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("alternate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitBeforeMutationLifeCycles")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        nextEffect "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("å¯¹äºä¸€ä¸ªç±»ç»„ä»¶ï¼Œè¿™ä¸€å‰¯ä½œç”¨æ„å‘³ç€ä¼šè°ƒç”¨Â "),a("code",[t._v("getSnapshotBeforeUpdate")]),t._v("Â ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ã€‚")]),t._v(" "),a("h3",{attrs:{id:"dom-æ›´æ–°"}},[t._v("DOM æ›´æ–°")]),t._v(" "),a("p",[t._v("commitAllHostEffectsæ˜¯ React æ‰§è¡Œ DOM æ›´æ–°çš„å‡½æ•°ã€‚è¯¥å‡½æ•°åŸºæœ¬ä¸Šå®šä¹‰äº†èŠ‚ç‚¹éœ€è¦å®Œæˆçš„æ“ä½œç±»å‹ï¼Œå¹¶æ‰§è¡Œè¿™äº›æ“ä½œï¼š")]),t._v(" "),a("div",{staticClass:"language-jsx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-jsx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitAllHostEffects")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("switch")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("primaryEffectTag"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" Placement"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitPlacement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" PlacementAndUpdate"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitPlacement")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" Update"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitWork")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("case")]),t._v(" Deletion"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("commitDeletion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("nextEffect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br")])]),a("p",[t._v("æœ‰è¶£çš„æ˜¯ï¼ŒReact è°ƒç”¨Â "),a("code",[t._v("componentWillUnmount")]),t._v("Â æ–¹æ³•ä½œä¸ºÂ "),a("code",[t._v("commitDeletion")]),t._v("Â å‡½æ•°ä¸­åˆ é™¤è¿‡ç¨‹çš„ä¸€éƒ¨åˆ†ã€‚")]),t._v(" "),a("h3",{attrs:{id:"æ›´æ–°åçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•"}},[t._v("æ›´æ–°åçš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•")]),t._v(" "),a("p",[t._v("commitAllLifecyclesÂ æ˜¯ React è°ƒç”¨æ‰€æœ‰å‰©ä½™ç”Ÿå‘½å‘¨æœŸæ–¹æ³•çš„å‡½æ•°ã€‚åœ¨ React çš„å½“å‰å®ç°ä¸­ï¼Œå”¯ä¸€ä¼šè°ƒç”¨çš„å˜æ›´æ–¹æ³•å°±æ˜¯Â "),a("code",[t._v("componentDidUpdate")]),t._v("ã€‚"),a("br"),t._v("æˆ‘ä»¬ç»ˆäºè®²å®Œäº†ã€‚è®©æˆ‘çŸ¥é“æ‚¨å¯¹è¯¥æ–‡ç« çš„çœ‹æ³•æˆ–åœ¨è¯„è®ºä¸­æå‡ºé—®é¢˜ã€‚æˆ‘è¿˜æœ‰å…³äºè°ƒåº¦ç¨‹åºã€å­è°ƒå’Œè¿‡ç¨‹ä»¥åŠå¦‚ä½•æ„å»ºå‰¯ä½œç”¨åˆ—è¡¨çš„æ–‡ç« æ¥å¯¹è¿™äº›å†…å®¹æä¾›æ·±å…¥çš„è§£é‡Šã€‚æˆ‘è¿˜è®¡åˆ’åˆ¶ä½œä¸€ä¸ªè§†é¢‘ï¼Œåœ¨è¿™é‡Œæˆ‘å°†å±•ç¤ºå¦‚ä½•ä½¿ç”¨æœ¬æ–‡ä½œä¸ºåŸºç¡€æ¥è°ƒè¯•åº”ç”¨ç¨‹åºã€‚")]),t._v(" "),a("hr")])}),[],!1,null,null,null);s.default=e.exports}}]);